<!DOCTYPE html>
<html lang="de" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="color-scheme" content="dark">
    <meta name="theme-color" content="#0f172a">
    <meta name="google" content="notranslate">
    <title>Anmelden ‚Äì FoodBot</title>
    <!-- Self-contained: only mobile.css, no base.css needed -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/mobile.css') }}">
</head>
<body>
    <div class="page">

        <header class="header">
            <h1 class="header__title">üçΩÔ∏è Essensanmeldung</h1>
            <p class="header__subtitle">{{ user.name }}</p>
        </header>

        <main class="content">

            {% if registration_closed %}
            <div class="alert">
                <span class="alert__icon">‚ö†Ô∏è</span>
                <p class="alert__text">Anmeldefrist √ºberschritten ‚Äì keine Anmeldung mehr m√∂glich</p>
            </div>
            {% endif %}

            <section class="card">
                <h2 class="card__label">Heutiges Men√º</h2>
                {% if menu %}
                    {% if menu.zwei_menues_aktiv %}
                    <div class="menu-choices">
                        <div class="menu-choice">
                            <span class="menu-choice__label">Men√º 1</span>
                            <span class="menu-choice__name">{{ menu.menu1_name }}</span>
                        </div>
                        <div class="menu-choice">
                            <span class="menu-choice__label">Men√º 2</span>
                            <span class="menu-choice__name">{{ menu.menu2_name }}</span>
                        </div>
                    </div>
                    {% else %}
                    <p class="card__text">{{ menu.description }}</p>
                    {% endif %}
                {% else %}
                    <p class="card__text card__text--muted">Kein Men√º verf√ºgbar</p>
                {% endif %}
            </section>

            <section class="card">
                {% if is_registered %}
                <div class="status status--registered">
                    <span class="status__icon">‚úÖ</span>
                    <p class="status__text">
                        Du bist angemeldet
                        {% if menu and menu.zwei_menues_aktiv and menu_choice %}
                            f√ºr <strong>{{ 'Men√º 1' if menu_choice == 1 else 'Men√º 2' }}</strong>
                        {% endif %}
                    </p>
                </div>
                {% else %}
                <div class="status">
                    <span class="status__icon">‚≠ï</span>
                    <p class="status__text">Noch nicht angemeldet</p>
                </div>
                {% endif %}
            </section>

        </main>

        <div class="actions">
            {% if is_registered %}
            <form method="post" action="/m/{{ token }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <input type="hidden" name="action" value="unregister">
                <button type="submit" class="btn btn--danger">Abmelden</button>
            </form>

            {% elif not registration_closed and menu %}
                {% if menu.zwei_menues_aktiv %}
                <form method="post" action="/m/{{ token }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="hidden" name="action" value="register">
                    <input type="hidden" name="menu_choice" value="1">
                    <button type="submit" class="btn btn--primary">Anmelden ‚Äì Men√º 1</button>
                </form>
                <form method="post" action="/m/{{ token }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="hidden" name="action" value="register">
                    <input type="hidden" name="menu_choice" value="2">
                    <button type="submit" class="btn btn--primary">Anmelden ‚Äì Men√º 2</button>
                </form>
                {% else %}
                <form method="post" action="/m/{{ token }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="hidden" name="action" value="register">
                    <button type="submit" class="btn btn--primary">Jetzt anmelden</button>
                </form>
                {% endif %}
            {% endif %}
        </div>

    </div>

    <script src="{{ url_for('static', filename='js/pages/mobile.js') }}" defer></script>
</body>
</html>
